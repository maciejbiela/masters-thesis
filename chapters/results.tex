\section{Outcomes}
\subsection{Bucketized}
\paragraph{}
Let us now look at the outcomes. Inputs have been grouped into buckets depending of the angle of the rail in the image by a step of 45$^{\circ}$. It resulted in very satisfying results as presented in the tables below - both for individual angles (tables \ref{tab:results_angle_0} through \ref{tab:results_angle_315}) and also in total (aggregated data from all buckets) - table \ref{tab:bucketized_results}.

\begin{table}[H]
    \centering
	\begin{spacing}{1.5}    
    \begin{tabular}{|l|l|l|}
        \hline
        \cellcolor{gray} & \textbf{Output: Same} & \textbf{Output: Different} \\ [0.5ex]
        \hline\hline
        \textbf{Actual: Same} & 12 & 1 \\ [0.5ex]
        \hline
        \textbf{Actual: Different} & 0 & 177 \\ [0.5ex]
        \hline
    \end{tabular}
    \end{spacing}
    \caption{Results for angle 0$^{\circ}$}
    \label{tab:results_angle_0}
\end{table}
            
\begin{table}[H]
    \centering
	\begin{spacing}{1.5}    
    \begin{tabular}{|l|l|l|}
        \hline
        \cellcolor{gray} & \textbf{Output: Same} & \textbf{Output: Different} \\ [0.5ex]
        \hline\hline
        \textbf{Actual: Same} & 5 & 1 \\ [0.5ex]
        \hline
        \textbf{Actual: Different} & 0 & 130 \\ [0.5ex]
        \hline
    \end{tabular}
    \end{spacing}
    \caption{Results for angle 45$^{\circ}$}
\end{table}
            
\begin{table}[H]
    \centering
	\begin{spacing}{1.5}    
    \begin{tabular}{|l|l|l|}
        \hline
        \cellcolor{gray} & \textbf{Output: Same} & \textbf{Output: Different} \\ [0.5ex]
        \hline\hline
        \textbf{Actual: Same} & 5 & 4 \\ [0.5ex]
        \hline
        \textbf{Actual: Different} & 0 & 162 \\ [0.5ex]
        \hline
    \end{tabular}
    \end{spacing}
    \caption{Results for angle 90$^{\circ}$}
\end{table}
            
\begin{table}[H]
    \centering
	\begin{spacing}{1.5}    
    \begin{tabular}{|l|l|l|}
        \hline
        \cellcolor{gray} & \textbf{Output: Same} & \textbf{Output: Different} \\ [0.5ex]
        \hline\hline
        \textbf{Actual: Same} & 8 & 1 \\ [0.5ex]
        \hline
        \textbf{Actual: Different} & 0 & 181 \\ [0.5ex]
        \hline
    \end{tabular}
    \end{spacing}
    \caption{Results for angle 135$^{\circ}$}
\end{table}
            
\begin{table}[H]
    \centering
	\begin{spacing}{1.5}    
    \begin{tabular}{|l|l|l|}
        \hline
        \cellcolor{gray} & \textbf{Output: Same} & \textbf{Output: Different} \\ [0.5ex]
        \hline\hline
        \textbf{Actual: Same} & 10 & 2 \\ [0.5ex]
        \hline
        \textbf{Actual: Different} & 0 & 264 \\ [0.5ex]
        \hline
    \end{tabular}
    \end{spacing}
    \caption{Results for angle 180$^{\circ}$}
\end{table}
            
\begin{table}[H]
    \centering
	\begin{spacing}{1.5}    
    \begin{tabular}{|l|l|l|}
        \hline
        \cellcolor{gray} & \textbf{Output: Same} & \textbf{Output: Different} \\ [0.5ex]
        \hline\hline
        \textbf{Actual: Same} & 6 & 1 \\ [0.5ex]
        \hline
        \textbf{Actual: Different} & 0 & 164 \\ [0.5ex]
        \hline
    \end{tabular}
    \end{spacing}
    \caption{Results for angle 225$^{\circ}$}
\end{table}
            
\begin{table}[H]
    \centering
	\begin{spacing}{1.5}    
    \begin{tabular}{|l|l|l|}
        \hline
        \cellcolor{gray} & \textbf{Output: Same} & \textbf{Output: Different} \\ [0.5ex]
        \hline\hline
        \textbf{Actual: Same} & 5 & 1 \\ [0.5ex]
        \hline
        \textbf{Actual: Different} & 0 & 130 \\ [0.5ex]
        \hline
    \end{tabular}
    \end{spacing}
    \caption{Results for angle 270$^{\circ}$}
\end{table}
            
\begin{table}[H]
    \centering
	\begin{spacing}{1.5}    
    \begin{tabular}{|l|l|l|}
        \hline
        \cellcolor{gray} & \textbf{Output: Same} & \textbf{Output: Different} \\ [0.5ex]
        \hline\hline
        \textbf{Actual: Same} & 13 & 0 \\ [0.5ex]
        \hline
        \textbf{Actual: Different} & 0 & 218 \\ [0.5ex]
        \hline
    \end{tabular}
    \end{spacing}
    \caption{Results for angle 315$^{\circ}$}
    \label{tab:results_angle_315}
\end{table}
            
\begin{table}[H]
    \centering
	\begin{spacing}{1.5}
    \begin{tabular}{|l|l|l|}
        \hline
        \cellcolor{gray} & \textbf{Output: Same} & \textbf{Output: Different} \\ [0.5ex]
        \hline\hline
        \textbf{Actual: Same} & 64 & 11 \\ [0.5ex]
        \hline
        \textbf{Actual: Different} & 0 & 1426 \\ [0.5ex]
        \hline
    \end{tabular}
    \end{spacing}
    \caption{Aggregated results}
    \label{tab:bucketized_results}
\end{table}
        
\begin{table}[H]
    \centering
	\begin{spacing}{1.5}    
    \begin{tabular}{|l|l|l|}
        \hline
        Sensitivity                 & 0.8533333333333334 \\
        \hline
        Specificity                 & 1.0 \\
        \hline
        Positive predictive value   & 1.0 \\
        \hline
        Negative predictive value   & 0.9923451635351427 \\
        \hline
        False positive rate         & 0.0 \\
        \hline
        False negative rate         & 0.1466666666666666 \\
        \hline
        False discovery rate        & 0.0 \\
        \hline
        Accuracy                    & 0.9926715522984677 \\
        \hline
        F1 score                    & 0.920863309352518 \\
        \hline
    \end{tabular}
    \end{spacing}
    \caption{Statistical measures of the algorithm - bucketized}
\end{table}

\subsection{Overall}
\paragraph{}
Table \ref{tab:overall_results} presents the result of applying the comparison algorithm across the whole set of input images.

\begin{table}[H]
    \centering
    \begin{spacing}{1.5}
    \begin{tabular}{|l|l|l|}
        \hline
        \cellcolor{gray} & \textbf{Output: Same} & \textbf{Output: Different} \\ [0.5ex]
        \hline\hline
        \textbf{Actual: Same} & 300 & 572 \\ [0.5ex]
        \hline
        \textbf{Actual: Different} & 5 & 11684 \\ [0.5ex]
        \hline
    \end{tabular}
    \end{spacing}
    \caption{Overall results}
    \label{tab:overall_results}
\end{table}
        
\begin{table}[H]
    \centering
    \begin{spacing}{1.5}
    \begin{tabular}{|l|l|l|}
        \hline
        Sensitivity                 & 0.3440366972477064 \\
        \hline
        Specificity                 & 0.9995722474120968 \\
        \hline
        Positive predictive value   & 0.9836065573770492 \\
        \hline
        Negative predictive value   & 0.9533289817232375 \\
        \hline
        False positive rate         & 0.00042775258790317405 \\
        \hline
        False negative rate         & 0.6559633027522935 \\
        \hline
        False discovery rate        & 0.016393442622950838 \\
        \hline
        Accuracy                    & 0.9540641668656954 \\
        \hline
        F1 score                    & 0.5097706032285472 \\
        \hline
    \end{tabular}
    \end{spacing}
    \caption{Statistical measures of the algorithm - all data}
\end{table}

\paragraph{}
The complete set of input data consisted of images of 13 actual rails. For every rail the number of images (different angles, different lighting) varied between 6 and 16 resulting in 158 images in total. The number of images with corresponding angles:
\begin{table}[H]
	\centering
	\begin{tabular}{|l|l|}
		\hline
		0$^{\circ}$		& 20 \\
		\hline
		45$^{\circ}$ 	& 17 \\
		\hline
		90$^{\circ}$ 	& 19 \\
		\hline
		135$^{\circ}$ 	& 20 \\
		\hline
		180$^{\circ}$ 	& 24 \\
		\hline
		225$^{\circ}$ 	& 19 \\
		\hline
		270$^{\circ}$ 	& 17 \\
		\hline
		315$^{\circ}$ 	& 22 \\
		\hline
	\end{tabular}
	\caption{Bucketized data summary}	
\end{table}

\section{Hypothesis verification}
\paragraph{}
In subsection \ref{subsect:angle_importance} it was mentioned that the angle under which the photo was taken plays significant role. Hence, it is our hypothesis. To confirm that we can compare sensitivities and specificities of both tests: bucketized and for all inputs. Two-sample tests for binomial proportions are appropriate for this setting ($\chi^2$ test and Fisher's exact test)\cite{diagnostic-testing}. The following code listing \ref{lst:comparison} presents a SAS program that will help us confirming this hypothesis.

\begin{lstlisting}[language=SAS, caption=SAS program for comparison of tests, label={lst:comparison}, basicstyle={\small, \ttfamily}]
proc format;
value yesnofmt 1='yes' 2='no';
run;

data sensitivity_diag1;
input same count;
format same yesnofmt.;
cards;
1 64
2 11
;
run;

proc freq data=sensitivity_diag1;
tables same/binomial alpha=0.05;
weight count;
title "Exact and Asymptotic 95% Confidence Intervals for Sensitivity - bucketized results";
run;

data sensitivity_diag2;
input same count;
format same yesnofmt.;
cards;
1 300
2 572
;
run;

proc freq data=sensitivity_diag2;
tables same/binomial alpha=0.05;
weight count;
title "Exact and Asymptotic 95% Confidence Intervals for Sensitivity - all results";
run;

data comparison_sensitivity;
input test same count;
format same yesnofmt.;
cards;
1 1 64 
1 2 11 
2 1 300
2 2 572 
;
run;

proc freq data=comparison_sensitivity;
tables same*test/chisq;
exact chisq;
weight count;
title "Exact and Asymptotic Tests for Comparing Sensitivities";
run;

data specificity_diag1;
input different count;
format different yesnofmt.;
cards;
1 1426
2 0
;
run;

proc freq data=specificity_diag1;
tables different/binomial alpha=0.05;
weight count;
title "Exact and Asymptotic 95% Confidence Intervals for Specificity - bucketized results";
run;

data specificity_diag2;
input different count;
format different yesnofmt.;
cards;
1 11684
2 5
;
run;

proc freq data=specificity_diag2;
tables different/binomial alpha=0.05;
weight count;
title "Exact and Asymptotic 95% Confidence Intervals for Specificity - all results";
run;

data comparison_specificity;
input test different count;
format different yesnofmt.;
cards;
1 1 1426
1 2 0
2 1 11684
2 2 5
;
run;

proc freq data=comparison_specificity;
tables different*test/chisq;
exact chisq;
weight count;
title "Exact and Asymptotic Tests for Comparing Specificities";
run;
\end{lstlisting}

\paragraph{}
Let us now concentrate on comparing sensitivities. Let $p_1$ be the sensitivity of bucketized test and $p_2$ the sensitivity of the overall test. The exact 95\% confidence intervals for the bucketized test are (0.7527, 0.9244) and for the overall tests (0.3125, 0.3766). Also the \textit{p}-value from Fisher's exact test for testing $H_0 : p_1 = p_2$ is $<.0001$. The conclusion is that the bucketized test has a significantly better sensitivity that the overall tests which confirms our hypothesis.